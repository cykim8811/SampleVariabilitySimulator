import{R as o,j as l}from"./index-ee043deb.js";/* empty css                 */const J=(f,g)=>{const a=o.useRef();o.useEffect(()=>{a.current=f},[f]),o.useEffect(()=>{function x(){var i;(i=a.current)==null||i.call(a)}if(g!==null){const i=setInterval(x,g);return()=>clearInterval(i)}},[g])};function K(f,g){let a=0,x=0;for(;a===0;)a=Math.random();for(;x===0;)x=Math.random();return f+g*Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*x)}function V(){var B;const f=o.useRef(null),g=o.useRef(null),[a,x]=o.useState(window.innerHeight-256),[i,N]=o.useState((window.innerHeight-256)*.5625),[m,E]=o.useState(i*(Math.random()*.6+.2)),[h,M]=o.useState([]),W=30,[T,_]=o.useState(10),[I,L]=o.useState(2),[c,R]=o.useState([]),[S,q]=o.useState(!0),[j,z]=o.useState(!1),[y,b]=o.useState(0),[p,P]=o.useState(1),[F,k]=o.useState(0),[X,C]=o.useState(0);o.useEffect(()=>{const t=Math.min(Math.ceil(Math.log2(c.length+4)*5),160),n=[];for(let r=0;r<t;r++)n.push(0);for(let r=0;r<c.length;r++)n[Math.floor(c[r]/i*t)]++;const e=g.current;if(!e)return()=>{};const s=e.getContext("2d");if(!s)return()=>{};s.clearRect(0,0,e.width,e.height),s.fillStyle="white",s.fillRect(0,0,e.width,e.height);const $=t/e.width*32;if(s.strokeStyle="rgba(0, 0, 0, 1)",s.lineWidth=1,s.beginPath(),s.moveTo(0,e.height),!j||c.length<2){for(let r=0;r<t;r++)s.lineTo(r/t*e.width,e.height-n[r]/c.length*e.height*$);s.lineTo(e.width,e.height)}else{const r=c.reduce((w,v)=>w+v)/c.length,H=Math.sqrt(c.reduce((w,v)=>w+Math.pow(v-r,2))/c.length);for(let w=1;w<320;w++){const v=w/320*e.width,A=Math.abs(v-r)/H,G=Math.exp(-Math.pow(A,2)/2)/Math.sqrt(2*Math.PI)/H;s.lineTo(w/320*e.width,e.height-G*e.height*(320/e.width*32))}s.lineTo(e.width,e.height)}s.stroke(),s.closePath()},[c,i,j]),o.useEffect(()=>{const t=f.current;if(!t)return;const n=t.getContext("2d");if(n){n.clearRect(0,0,t.width,t.height),n.fillStyle="black",n.fillRect(0,0,t.width,t.height),n.fillStyle="white",(!S||y>0)&&n.fillRect(m-5,5,10,10),n.strokeStyle="rgba(255, 255, 255, 1)",n.lineWidth=2;for(let e=0;e<h.length;e++)y<=0&&S&&h[e].y<a-32||(n.beginPath(),n.moveTo(h[e].x+h[e].xSpeed,h[e].y),n.lineTo(h[e].x+h[e].xSpeed,h[e].y+W),n.stroke(),n.closePath());for(let e=0;e<c.length;e++)n.fillStyle="rgba(255, 255, 255, 0.3)",n.beginPath(),n.arc(c[e],a-10,2,0,2*Math.PI),n.fill();if(S&&y<=0){n.fillStyle="rgba(64, 64, 64, 1)",n.fillRect(0,0,t.width,t.height*.9);for(let e=0;e<20;e++)n.fillStyle=`rgba(64, 64, 64, ${1-e/20})`,n.fillRect(0,t.height*.9+e*t.height*.07/20-2,t.width,t.height*.2/20)}}},[m,h]);function D(){R([]);const t=i*(Math.random()*.6+.2);E(t);const n=[];for(let e=0;e<T;e++)n.push({x:t,y:20,xSpeed:K(0,I)});M(n)}function U(t){var e;if(f.current===null)return;const n=t-((e=f.current)==null?void 0:e.getBoundingClientRect().left);console.log(n,m,p),!(t<=0)&&(Math.abs(n-m)<p/2&&k(s=>s+1),C(s=>s+1))}o.useEffect(()=>{C(0),k(0)},[p]),J(()=>{const t=[];for(let n=0;n<h.length;n++)h[n].y<a-10-W?t.push({x:h[n].x+h[n].xSpeed,y:h[n].y+W,xSpeed:h[n].xSpeed}):R(e=>[...e,h[n].x]);M(t)},10),o.useEffect(()=>{function t(){x(window.innerHeight-256),N((window.innerHeight-256)*.5625)}return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const u=-32,d=96,Y=f.current?y-((B=f.current)==null?void 0:B.getBoundingClientRect().left):0;return l.jsxs("div",{className:"Experiment3",children:[l.jsx("canvas",{ref:f,height:a,width:i,style:{margin:"0 auto",position:"absolute",left:"0",right:"0"}}),l.jsx("canvas",{ref:g,height:96,width:i,style:{border:"1px solid black",margin:"0 auto",position:"absolute",left:"0",right:"0",top:a+96}}),l.jsx("label",{style:{color:"white",fontWeight:"bold",position:"absolute",left:window.innerWidth/2+i/2-54+u,top:d+56},children:"n"}),l.jsx("input",{type:"number",value:T,onChange:t=>_(parseInt(t.target.value)),style:{position:"absolute",left:window.innerWidth/2+i/2-36+u,top:d+56,width:48}}),l.jsx("label",{style:{color:"white",fontWeight:"bold",position:"absolute",left:window.innerWidth/2+i/2-54+u,top:d+24},children:"σ"}),l.jsx("input",{type:"number",value:I,onChange:t=>L(parseInt(t.target.value)),style:{position:"absolute",left:window.innerWidth/2+i/2-36+u,top:d+24,width:48}}),l.jsx("input",{className:"checkbox",type:"checkbox",checked:S,onChange:t=>q(t.target.checked),style:{position:"absolute",left:window.innerWidth/2+i/2-12+u,top:d+88}}),l.jsx("label",{style:{color:"white",fontWeight:"bold",position:"absolute",left:window.innerWidth/2+i/2-44+u,top:d+84},children:"Fog"}),l.jsx("input",{className:"checkbox",type:"checkbox",checked:j,onChange:t=>z(t.target.checked),style:{position:"absolute",left:window.innerWidth/2+i/2-12+u,top:d+118}}),l.jsx("label",{style:{color:"white",fontWeight:"bold",position:"absolute",left:window.innerWidth/2+i/2-57+u,top:d+116},children:"Norm"}),l.jsx("button",{onClick:()=>{R([]),E(i/2),M([]),C(0),k(0)},style:{position:"absolute",left:window.innerWidth/2+i/2-24+u,top:d+158},children:"Reset"}),l.jsx("input",{type:"range",min:"1",max:"100",value:p,onChange:t=>P(parseInt(t.target.value)),style:{position:"absolute",left:window.innerWidth/2+i/2-68+u,top:d+190,width:"96px"}}),l.jsx("input",{type:"number",min:"1",max:"100",value:p,onChange:t=>P(parseInt(t.target.value)),style:{position:"absolute",left:window.innerWidth/2+i/2-32+u,top:d+208}}),l.jsx("div",{className:"success_rate",style:{color:"white",fontWeight:"bold",position:"absolute",left:window.innerWidth/2+i/2-32+u,top:d+248},children:X===0?"- %":(F/X*100).toFixed(0)+"%"}),l.jsxs("div",{style:{borderBottom:"1px solid lightgray",width:"321px",backgroundColor:"white",userSelect:"none",position:"absolute",left:window.innerWidth/2-160,top:a+200,height:"368px"},onTouchStart:t=>{b(t.touches[0].clientX)},onMouseDown:t=>{b(t.clientX),U(t.clientX)},onTouchEnd:()=>{b(-1e3)},onTouchCancel:()=>{b(-1e3)},onMouseMove:t=>{t.buttons===1&&b(t.clientX)},onTouchMove:t=>b(t.touches[0].clientX),onMouseUp:()=>{b(-1e3),D()},children:["비교",l.jsx("div",{style:{position:"fixed",backgroundColor:Math.abs(Y-m)<p/2?"rgba(0, 255, 0, 0.5)":"rgba(255, 0, 0, 0.5)",width:p+"px",height:"90vh",top:"72px",left:Math.floor(y-p/2)+"px"}})]})]})}export{V as default};
